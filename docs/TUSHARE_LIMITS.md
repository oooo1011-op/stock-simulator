# Tushare积分与频次限制

## 用户积分情况
- **当前积分**: 2000
- **对应权限**: 
  - 每分钟频次: **200次**
  - 每天总量: **100,000次/个API**
  - 可访问接口: 日线行情、财务数据、每日指标等常用数据

## 主板数据规模估算
- **主板股票数量**: 约3000只（上海600/601/603 + 深圳000/001/002）
- **时间范围**: 2008-2025年，约17年
- **交易日**: 约250天/年 × 17年 = 4250天
- **总数据量**: 3000只 × 4250天 = 约1275万条日线记录

## API调用规划

### 日线行情接口 (daily)
- 每次最多获取6000行数据
- 需要调用次数: 1275万 / 6000 ≈ 2125次
- 按每分钟200次，约需: 2125 / 200 = 11分钟
- 总请求量在日限制10万次内 ✅

### 股票基本信息 (stock_basic)
- 单次调用，获取全部股票列表

### 每日指标 (daily_basic)
- 与日线条数相同

## 频次控制策略
1. **主限流**: 每分钟最多200次请求
2. **安全裕度**: 实际限制设为180次/分钟（90%）
3. **批量获取**: 每次请求尽可能多股票
4. **增量更新**: 后续只更新新数据

## 量纲和单位确认

### Tushare日线数据 (daily接口)
| 字段 | 类型 | 单位 | 说明 |
|------|------|------|------|
| ts_code | str | - | 股票代码(如000001.SZ) |
| trade_date | str | - | 交易日期(YYYYMMDD) |
| open | float | 元 | 开盘价 |
| high | float | 元 | 最高价 |
| low | float | 元 | 最低价 |
| close | float | 元 | 收盘价 |
| pre_close | float | 元 | 昨收价 |
| change | float | 元 | 涨跌额 |
| pct_chg | float | % | 涨跌幅(未乘100) |
| vol | float | 手 | 成交量(100股=1手) |
| amount | float | 千元 | 成交额(1000元) |

### 数据库字段映射
```python
# Tushare -> Database
ts_code -> stock_code (去掉.SZ/.SH后缀)
trade_date -> date
open -> open (元)
high -> high (元)
low -> low (元)
close -> close (元)
vol -> volume (手)
amount -> amount (千元)
```

### 单位转换
- **价格**: 保持元，无需转换
- **成交量**: Tushare是"手"，akshare也是"手"，保持一致
- **成交额**: Tushare是"千元"，注意与其他数据源统一

## 多数据源优先级
1. **主源**: Tushare (pro.daily)
2. **备用源1**: Akshare (ak.stock_zh_a_hist)
3. **备用源2**: Baostock (bs.query_history_k_data_plus)

## 错误处理策略
- Tushare限制/失败 -> 自动切换Akshare
- Akshare失败 -> 切换Baostock
- 所有源失败 -> 记录错误，跳过该股票
